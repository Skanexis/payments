{% extends "base.html" %}
{% block content %}
  <section class="panel">
    <div class="section-head">
      <div>
        <h1>Наблюдаемые транзакции</h1>
        <p class="hint">Сюда попадают входящие переводы, включая нераспознанные. Это основной экран для разбора спорных случаев.</p>
      </div>
    </div>
    <div class="table-wrap">
      <table>
        <thead>
        <tr>
          <th>Сеть</th>
          <th>Tx hash</th>
          <th>Сумма</th>
          <th>Подтв.</th>
          <th>Статус</th>
          <th>Payment</th>
          <th>Последнее обновление</th>
        </tr>
        </thead>
        <tbody>
        {% for t in transfers %}
          <tr>
            <td data-label="Сеть">{{ t.network }}</td>
            <td data-label="Tx hash" class="mono">{{ t.tx_hash }}</td>
            <td data-label="Сумма" class="mono">{{ t.amount|amt if t.amount else "-" }}</td>
            <td data-label="Подтв.">{{ t.confirmations }}</td>
            <td data-label="Статус"><span class="status-pill status-{{ t.match_status }}">{{ t.match_status }}</span></td>
            <td data-label="Payment" class="mono">
              {% if t.matched_payment_id %}
                <a href="/admin/payments/{{ t.matched_payment_id }}">{{ t.matched_payment_id[:8] }}</a>
              {% else %}
                -
              {% endif %}
            </td>
            <td data-label="Обновлено">{{ t.last_seen_at|dt }}</td>
          </tr>
        {% else %}
          <tr>
            <td class="empty-cell" colspan="7">Транзакций пока нет.</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </section>
{% endblock %}
