{% extends "base.html" %}
{% block content %}
  <section class="panel">
    <div class="section-head">
      <div>
        <h1>Платежи</h1>
        <p class="hint">Операционная панель инвойсов и статусов оплат.</p>
      </div>
      <a class="btn btn-primary" href="/admin/payments/new">Создать платеж</a>
    </div>
    <div class="grid grid-4">
      <article class="metric">
        <div class="label">Всего</div>
        <div class="value">{{ stats_total }}</div>
      </article>
      <article class="metric">
        <div class="label">Ожидают</div>
        <div class="value">{{ stats_pending }}</div>
      </article>
      <article class="metric">
        <div class="label">Подтверждения</div>
        <div class="value">{{ stats_confirming }}</div>
      </article>
      <article class="metric">
        <div class="label">Оплачены</div>
        <div class="value">{{ stats_paid }}</div>
      </article>
    </div>
  </section>

  <section class="panel">
    <div class="section-head">
      <h2>Последние 100 платежей</h2>
    </div>
    <div class="table-wrap">
      <table>
        <thead>
        <tr>
          <th>ID</th>
          <th>Название</th>
          <th>Сеть</th>
          <th>Сумма</th>
          <th>Статус</th>
          <th>Создан</th>
        </tr>
        </thead>
        <tbody>
        {% for payment in payments %}
          <tr>
            <td data-label="ID"><a class="mono" href="/admin/payments/{{ payment.id }}">{{ payment.id[:8] }}</a></td>
            <td data-label="Название">{{ payment.title }}</td>
            <td data-label="Сеть">{{ payment.network }}</td>
            <td data-label="Сумма" class="mono">{{ payment.pay_amount|amt }}</td>
            <td data-label="Статус"><span class="status-pill status-{{ payment.status }}">{{ payment.status }}</span></td>
            <td data-label="Создан">{{ payment.created_at|dt }}</td>
          </tr>
        {% else %}
          <tr>
            <td class="empty-cell" colspan="6">Пока платежей нет.</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </section>
{% endblock %}
